<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/tools/xml/casa.xsd">


<tool name="testflagger" module="testflagger">
<code>
	<include>tools/flagging/testflagger_forward.h</include>
<private>
	<include>tools/flagging/testflagger_private.h</include>
</private>
</code>

        <shortdescription>Tool for manual and automated flagging</shortdescription>
       
<description>
The {\tt testflagger} tool performs manual as well as automatic synthesis
flagging operations within casapy. The {\tt testflagger} tool can operate on
one measurement set at a time.

 \medskip\noindent\textbf{Open the Measurement Set and Attach it to the Tool}

  The first thing to do is to open the Ms and attach it to the testflagger tool.
  Use the tf.open method, which requires the MS name and optionally the time interval,
  over which to buffer data before running the algorithm. The time interval is set by
  default to 0.0, which means a 'scan' length. The 'ntime' parameter is important for
  the modes tfcrop, rflag and extend. From version 3.4 on, it is also possible to
  flag CAL tables. Give the CAL table name instead of the MS.

  \t tf.open('uid_X002.ms')


 \medskip\noindent\textbf{Select the Data}

  Once the MS is open, the next step is to select the data. This step will use the MS
  selection tool to select the portion of the MS given by the parameters. There are two ways
  of selecting the data:

  1) Create a Python dictionary which internally will be transformed into a record
     containing the selection parameters.

     Select the whole MS.
     tf.selectdata()

     Select a portion of the MS using a dictionary.
     myrecord={}
     myrecord['scan']='1~3'
     myrecord['spw']='0:1~10'
     tf.selectdata(myrecord)

   2) Parse the parameters names directly to the function.

     tf.selectdata(scan='1~3', spw='0:1~10')


 \medskip\noindent\textbf{Parse the Parameters for the Flagging Mode(s)}

  Each flagging mode is called an agent. The available agents are: manual, clip, quack,
  shadow, elevation, tfcrop, rflag, extend, unflag and summary. Each one of these agents
  may or may not take configuration parameters and data selection parameters. Once the desired
  flagging modes are chosen, it is time to give the configuration parameters to the tool. Ommited
  parameters will take default values as defined in each agent. There are
  two ways of parsing the agent's parameters.

  1) Using the general method tf.parseagentparameters().

     Construct a dictionary with the parameters for each agent. Each agent's
     parameters should go to a different 'key' of the dictionary. Example:

     # Create a shadow agent:
     myagents = {}
     myagents['mode'] = 'shadow'
     tf.parseagentparameters(myagents)

     # Add a summary agent to the list.
     myagents = {}
     myagents['mode'] = 'summary
     myagents['spwchan] = True
     tf.parseagentparameters(myagents)

     # Add a manual agent to the same internal list of agents.
     myagents = {}
     myagents['mode'] = 'manual'
     myagents['scan'] = '1~3,18~20'
     tf.parseagentparameters(myagents)

     # Add a clip agent to flag the zero-value data.
     myagents = {}
     myagents['mode'] = 'clip'
     myagents['clipzeros'] = True
     tf.parseagentparameters(myagents)
     
     # Add another summary agent to the list.
     myagents = {}
     myagents['mode'] = 'summary
     myagents['spwchan] = True
     tf.parseagentparameters(myagents)

   2) The other way to parse agent's parameters is to use the convenience functions.
      The above example would become:

     # Create a shadow agent:
     tf.parseshadowparameters()

     # Add a summary agent to the list.
     tf.parsesummaryparameters(spwchan=True)

     # Add a manual agent to the same internal list of agents.
     tf.parsemanualparameters(scan='1~3,18~20')

     # Add a clip agent to flag the zero-value data.
     tf.parseclipparameters(clipzeros=True)
     
     # Add another summary agent to the list.
     tf.parsesummaryparameters(spwchan=True)
     

 \medskip\noindent\textbf{Initialize the Agents}

  The above step creates a list of the agents that the tool will use to process the data.
  This step will check several parameters and apply constraints. It will set the iteration approach
  to COMBINE_SCANS_MAP_ANTENNA_PAIRS_ONLY if the agent is either tfcrop or extend and combinescans
  is set to True. Otherwise it will set it to COMPLETE_SCAN_MAP_ANTENNA_PAIRS_ONLY.

  If the list contains agents that set ntime more than once, this method will get the maximum value
  of ntime and use it for all agents.

  If a tfcrop agent is present, this method will create one agent per each polarization available,
  if correlation is set to ALL.

  In the same way, if an agent tfcrop, rflag or clip is present, the asyncio mechanism will be switched
  on.

  tf.init()

 \medskip\noindent\textbf{Run the tool}

  Run the tool to apply or unapply the flags. The run method takes two parameters, writeflags and sequential.
  The parameter writeflags controls whether to write the flags or not to the MS. By default it is set to True.
  The sequential parameter tells to apply/unapply the flags in parallel or not. By default it is set to False,
  which means that the agents will run in parallel.

  The run method gathers several reports, depending on wich agents are run. The display and summary agents
  produce reports that can be retrieved from calling the run method. The reports are returned via a Python
  dictionary.

  myreports = tf.run(writeflags=True)
  
  The dictionary returned in 'myreports' will contain four reports from the two summary agents that were
  added previously. The first report is the normal summary for each selection parameter. The second report
  gives the antenna positions for plotting.

 \medskip\noindent\textbf{Destroy the tool}

  Do not forget to destroy and close the tool at the end.
  
  tf.done()

</description>


   <method type="constructor" name="testflagger">
   <shortdescription>Construct a flag tool</shortdescription>
   
<description>
Create a {\tt testflagger} tool, and initializes some variables.
</description>
<input>

</input>
<returns type="unknown">testflagger tool</returns>
<example>

tf.testflagger()      

</example>
</method>

<!-- ********************************************************************** -->

   <method type="function" name="done">
   <shortdescription>Destroys the flag tool</shortdescription>
   
<returns type="bool"/>
<example>
tf.done()

</example>
</method>

<!-- ********************************************************************** -->

   <method type="function" name="open">
   <shortdescription>Opens the MS and attaches it to the tool.</shortdescription>

<input>

     <param type="string" name="msname">
     <description>Measurement set to be processed. Default:  </description>
     <value></value>
     </param>
     <param type="double" name="ntime">
     <description>Time interval. If not given, the default will be used. Default: </description>
     <value>0.0</value>
     </param>
</input>

<example>
tf.open(msname,ntime)
</example>
<returns type="bool"/> 
</method>


<!-- ********************************************************************** -->

 
   <method type="function" name="selectdata">
   <shortdescription>Selects the data based on the given parameters.
For unspecified parameters, the full data range is assumed.
All data selection parameters follow the ms-selection syntax.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="record" name="config"> 
     <description>The record (dictionary) config may be given or not. If it is not given, 
     \n and no specific parameter is given either, the whole MS will be selected. The record 
     \n may contain any data selection parameters supported by MSSelection such as:\n
     </description>     
     <value type="record"></value>
     </param>

     <param type="string" name="field">
     <description>\tField indices or source names : example : '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names : example : '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names : example : 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name : example : '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number : example : '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number : example : '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit : example : '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings : example : 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations : example : 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent : example : '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id : example : '2~4' </description>
     <value></value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
Select the whole MS
tf.selectdata()

Select a portion of the MS
myrecord={}
myrecord['scan']='1~3'
myrecord['spw']='0:1~10'
tf.selectdata(myrecord)

Another way to select a portion of the MS
tf.selectdata(scan='3~5', spw='0')
</example>

<returns type="bool"/> 
</method>


<!-- ********************************************************************** -->

   <method type="function" name="parseagentparameters">
   <shortdescription>Parses the parameters for the agent (flagging mode).</shortdescription>
   
<description>The specific data selection parameters for the agent (flagging mode)
are parsed. These parameters are the data selection and mode-specific parameters.
See the example below:
</description>

<input>

     <param type="record" name="aparams">
     <description>It takes a record (dictionary) with the specific parameters for the flagging mode. 
     \n The record may contain any data selection parameters supported by MSSelection, as well as 
     \n mode-specific parameters such as:\n
     \n (1) array,feed,scan,field,spw,intent,correlation,antenna,uvrange,observation
     \n (2) mode (which can be: manual,clip,quack,shadow,elevation,tfcrop,extendflags,unflag or summary)
     \n     For flagging mode=clip, the parameters are: expression, datacolumns, clipminmax, etc.
     \n     See the documentation of the task tflagger for all the available parameters for each mode.\n
     \n (3) apply: default is true (true for flagging and false for unflagging)
     \n Example:\n\n
myrecord={}\n
myrecord['mode']='clip'\n
myrecord['scan']='1~3'\n
myrecord['clipminmax']=[0.02,0.3]\n
myrecord['apply']=True\n
tf.parseAgentParameters(myrecord)\n
     
     </description>
     </param>
     
</input>
<example>
myrecord={}
myrecord['mode']='clip'
myrecord['scan']='1~3'
myrecord['clipminmax']=[0.02,0.3]
myrecord['apply']=True
tf.parseAgentParameters(myrecord)
</example>
<returns type="bool"/> 
</method>


<!-- ********************************************************************** -->

   <method type="function" name="init">
   <shortdescription>Initialize the agents</shortdescription>
   
<description>This method will initialize the agents and create a list of agents
with their specific parameters. It takes no parameters.
</description>

<input>
</input>
<returns type="bool"/> 
</method>

<!-- ********************************************************************** -->

   <method type="function" name="run">
   <shortdescription>Executes a flagging run</shortdescription>
   
<description>
Executes a flagging run.
</description>
<input>
     <param type="bool" name="writeflags">
     <description>Write flags to MS</description>
     <value>true</value>
     </param>

     <param type="bool" name="sequential">
     <description>Run the task in sequential or parallel mode</description>
     <value>true</value>
     </param>

</input>
<returns type="record"/>
<example>
</example>
</method>


<!-- ********************************************************************** -->

    <method type="function" name="getflagversionlist">
   <shortdescription>Print out a list of saved flag_versions.</shortdescription>
<description> 
Print out the list of flag versions in the MS, unless the parameter printflags=False. The list of names is returned.
</description>
<input>
     <param type="bool" name="printflags">
     <description>Print flagversions in logger?</description>
     <value>true</value>
     </param>
</input>
<returns type="stringArray"/>
</method>

<!-- ********************************************************************** -->

   <method type="function" name="printflagselection">
   <shortdescription>Print out a list of current flag selections.
   </shortdescription>
   
<description>
Print out a list of current flag selections.
</description>
<input>
</input>
<returns type="bool"/>
</method>

<!-- ********************************************************************** -->

   <method type="function" name="saveflagversion">
   <shortdescription>Save current flags with a version name.
            </shortdescription>
<description> 
</description>
<input>
     <param type="string" name="versionname">
     <description>Version name </description>
     <value></value>
     </param>
     <param type="string" name="comment">
     <description>Comment for this flag table </description>
     <value></value>
     </param>
     <param type="string" name="merge">
     <description>merge type </description>
     <value></value>
     </param>
</input>
<returns type="bool"/>
</method>


<!-- ********************************************************************** -->

   <method type="function" name="restoreflagversion">
   <shortdescription>Restore flags from a saved flag_version. 
			\n versionname : name of flag version to restore to main table
			\n merge : Type of operation to perform during restoration.
			\n        merge = replace  : replaces the main table flags.
			\n        merge = and   : logical AND with main table flags
			\n        merge = or    : logical OR with main table flags
			\n        Default : replace.
 			  \n
   </shortdescription>
<description> 
</description>
<input>
     <param type="stringArray" name="versionname">
     <description>Version name </description>
     <value></value>
     </param>
     <param type="string" name="merge">
     <description>merge type </description>
     <value></value>
     </param>
</input>
<returns type="bool"/>
</method>

<!-- ********************************************************************** -->


    <method type="function" name="deleteflagversion">
   <shortdescription>Delete a saved flag_version.</shortdescription>
<description> 
</description>
<input>
     <param type="stringArray" name="versionname">
     <description>Version name </description>
     <value></value>
     </param>
</input>
<returns type="bool"/>
</method>

<!-- ********************************************************************** -->

   <method type="function" name="parsemanualparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the manual mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

     <param type="bool" name="autocorr">
     <description>\tParameter to flag only auto-correlations. Default: </description>
     <value>false</value>
     </param>
     
     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag the data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
tf.parsemanualparameters(autocorr=True)
</example>

<returns type="bool"/> 
</method>

<!-- ********************************************************************** -->

   <method type="function" name="parseclipparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the clip mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>
    
     <param type="string" name="datacolumn">
     <description>\tData column to use for clipping. Example: 'DATA'. Default:
     </description>
     <value>DATA</value>
     </param>

     <param type="doubleArray" name="clipminmax">
     <description>\tRange to use for clipping. Example: [100.0,200.0] 
     </description>
     <value type="vector"></value>
     </param>
     
     <param type="bool" name="clipoutside">
     <description>Clip points outside this range? [True/False]. Default:
     </description>
     <value>true</value>
     </param>
    
     <param type="bool" name="channelavg">
     <description>\tAverage data over channels before clipping? [True/False]. Default:
     </description>
     <value>false</value>
     </param>

          <param type="bool" name="clipzeros">
     <description>\tClip zero-value data. [True/False]. Default:
     </description>
     <value>false</value>
     </param>
     
     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
The correlation parameter can be used with an operator for the clip mode.
The operator should be written only once and it will affect all the polarizations
given in the string. See the example below:

tf.parseclipparameters(clipzeros=True, clipminmax=[0.,4.], correlation='ABS_XX,XY')
</example>

<returns type="bool"/> 
</method>

<!-- ********************************************************************** -->

   <method type="function" name="parsequackparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the quack mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

     <param type="string" name="quackmode">
     <description>\tQuack mode. Default: </description>
     <value>beg</value>
     </param>

     <param type="double" name="quackinterval">
     <description>Quack length in seconds. Default: </description>
     <value>0.0</value>
     </param>

     <param type="bool" name="quackincrement">
     <description>Flag incrementally in time. Default:</description>
     <value>false</value>
     </param>

     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag the data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
tf.parsequackparameters(scan='1~3', quackmode='beg', quackinterval=1)
</example>

<returns type="bool"/> 
</method>

<!-- ********************************************************************** -->

   <method type="function" name="parseelevationparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the elevation mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

     <param type="double" name="lowerlimit">
     <description>The limiting elevation in degrees. Data obtained at lower antenna elevations will get flagged. Default: 
     </description>
     <value>0.0</value>
     </param>

     <param type="double" name="upperlimit">
     <description>The limiting elevation in degrees. Data obtained at higher antenna elevations will get flagged. Default:
     </description>
     <value>90.0</value>
     </param>

     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag the data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
To unflag, set the apply parameter.
tf.parseelevationparameters(upperlimit=50.,lowerlimit=10.0, apply=False)
</example>

<returns type="bool"/> 
</method>

<!-- ********************************************************************** -->

   <method type="function" name="parsetfcropparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the time and frequency mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

            <param type="double" name="ntime">
                <description>\tTime-range to use for each chunk (in seconds or minutes)</description>
                <value>0.0</value>
            </param>
            <param type="bool" name="combinescans">
                <description>Accumulate data across scans.</description>
                <value>false</value>
            </param>
    
           <param type="string" name="datacolumn">
                <description>\tData column to use for clipping. Example: 'DATA'. Default:
                </description>
                <value>DATA</value>
            </param>
            <param type="double" name="timecutoff">
                <description>Flagging thresholds in units of deviation from the fit. Default:</description>
                <value>4.0</value>
            </param>
            <param type="double" name="freqcutoff">
                <description>Flagging thresholds in units of deviation from the fit. Default:</description>
                <value>3.0</value>
            </param>
            <param type="string" name="timefit">
                <description>\tFitting function for the time direction (poly/line). Default: </description>
                <value>line</value>
            </param>
            <param type="string" name="freqfit">
                <description>\tFitting function for the frequency direction (poly/line). Default: </description>
                <value>poly</value>
            </param>
            <param type="int" name="maxnpieces">
                <description>Number of pieces in the polynomial-fits (for \'freqfit\' or \'timefit\' = \'poly\'). Default: </description>
                <value>7</value>
            </param>
            <param type="string" name="flagdimension">
                <description>Dimensions along which to calculate fits (freq/time/freqtime/timefreq). Default: </description>
                <value>freqtime</value>
            </param>
            <param type="string" name="usewindowstats">
                <description>Calculate additional flags using sliding window statistics (none,sum,std,both). Default: </description>
                <value>none</value>
            </param>
            <param type="int" name="halfwin">
                <description>\tHalf-width of sliding window to use with \'usewindowstats\' (1,2,3). Default: </description>
                <value>1</value>
            </param>

     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag the data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
The correlation parameter can be used with an operator for the tfcrop mode.
The operator should be written only once and it will affect all the polarizations
given in the string. See the example below:

tf.parsetfcropparameters(spw='9', ntime=10.0, combinescans=True, correlation='ABS_XX,XY')
</example>

<returns type="bool"/> 
</method>


<!-- ********************************************************************** -->

   <method type="function" name="parseextendparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the extend mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

    <param type="double" name="ntime">
        <description>\tTime-range to use for each chunk (in seconds or minutes). Default: </description>
        <value>0.0</value>
    </param>
    <param type="bool" name="combinescans">
        <description>Accumulate data across scans.. Default: </description>
        <value>false</value>
    </param>
    <param type="bool" name="extendpols">
        <description>If any correlation is flagged, flag all correlations. Default: </description>
        <value>true</value>
    </param>

   <param type="double" name="growtime">
        <description>\tFlag all \'ntime\' integrations if more than X% of the timerange is flagged (0-100). Default: </description>
        <value>50.0</value>
    </param>
    <param type="double" name="growfreq">
        <description>\tFlag all selected channels if more than X% of the frequency range is flagged(0-100). Default: </description>
        <value>50.0</value>
    </param>
    <param type="bool" name="growaround">
        <description>Flag data based on surrounding flags. Default: </description>
        <value>false</value>
    </param>
    <param type="bool" name="flagneartime">
        <description>Flag one timestep before and after a flagged one. Default: </description>
        <value>false</value>
    </param>
    <param type="bool" name="flagnearfreq">
        <description>Flag one channel before and after a flagged one. Default: </description>
        <value>false</value>
    </param>

     <param type="bool" name="apply">
     <description>\tParameter to flag or unflag the data. Default: </description>
     <value>true</value>
     </param>

<!-- Selection parameters : end -->
     
</input>
<example>
tf.parseextendparameters(extendpols=True)
</example>

<returns type="bool"/> 
</method>


<!-- ********************************************************************** -->

   <method type="function" name="parsesummaryparameters">
   <shortdescription>Parses data selection parameters and specific parameters
for the summary mode.
    </shortdescription>

<input>

<!-- Selection parameters : start -->
     <param type="string" name="field">
     <description>\tField indices or source names. Example: '2,3C48' </description>
     <value></value>
     </param>
     
     <param type="string" name="spw">
     <description>\tSpectral Window Indices or names. Example: '1,2' </description>
     <value></value>
     </param>
    
     <param type="string" name="array">
     <description>\tArray Indices or names. Example: 'VLAA' </description>
     <value></value>
     </param>
    
     <param type="string" name="feed">
     <description>\tFeed index or name. Eexample: '1,2' (not supported yet) </description>
     <value></value>
     </param>
    
     <param type="string" name="scan">
     <description>\tScan number. Example: '1,2,3' </description>
     <value></value>
     </param>   

     <param type="string" name="antenna">
     <description>\tBaseline number. Example: '2-3,4-5,132 ????' </description>
     <value></value>
     </param>
    
     <param type="string" name="uvrange">
     <description>\tUV-distance range, with a unit. Example: '2.0-3000.0 m'</description>
     <value></value>
     </param>
    
     <param type="string" name="time">
     <description>\tTime range, as MJDs or date strings. Example: 'xx.x.x.x.x~yy.y.y.y.y'</description>
     <value></value>
     </param>

     <param type="string" name="correlation">
     <description>Correlations/polarizations. Example: 'RR,LL,RL,LR,XX,YY,XY,YX'</description>
     <value></value>
     </param>

     <param type="string" name="intent">
     <description>\tScan intent. Example: '*CAL*, *BAND*' </description>
     <value></value>
     </param>
     
     <param type="string" name="observation">
     <description>Observation Id. Example: '2~4' </description>
     <value></value>
     </param>

     <param type="bool" name="spwchan">
     <description>\tList the number of flags per spw and per channel. Default: </description>
     <value>false</value>
     </param>

     <param type="bool" name="spwcorr">
     <description>\tList the number of flags per spw and per correlation. Default: </description>
     <value>false</value>
     </param>

     <param type="bool" name="basecnt">
     <description>\tList the number of flags per baseline. Default: </description>
     <value>false</value>
     </param>
     
<!-- Selection parameters : end -->
     
</input>
<example>
tf.parsesummaryparameters(spwchan=True, basecnt=True)
</example>

<returns type="bool"/> 
</method>

</tool>
</casaxml>



