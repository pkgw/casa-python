<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<task type="function" name="exportasdm" category="import/export">

  <shortdescription>Convert a CASA visibility file (MS) into an ALMA Science Data Model</shortdescription>

  <input>

    <param type="string" name="vis" kind="ms" mustexist="true">
          <description>MS name</description>
          <value></value>
    </param>


    <param type="string" name="asdm" kind="asdm" mustexist="false">
          <description>Name of output ASDM directory (on disk)</description>
          <value></value>
    </param>

    <param type="string" name="datacolumn"  ignorecase="True">
	    <description>specifies which MS data column is used to fill the visibilites in the ASDM</description>
	    <value>data</value>
	    <allowed kind="enum">
	       <value>data</value>
	       <value>corrected</value>
	       <value>model</value>
	    </allowed>
    </param>
    <param type="string" name="archiveid">
	    <description>the X0 in uid://X0/X1/X&lt;running&gt;</description>
	    <value>S0</value>
    </param>
    <param type="string" name="rangeid">
	    <description>the X1 in uid://X0/X1/X&lt;running&gt;</description>
	    <value>X1</value>
    </param>
    <param type="string" name="subscanduration">
	    <description>maximum duration of a subscan in the output ASDM</description>
	    <value>24h</value>
    </param>
    <param type="string" name="sbduration">
	    <description>maximum duration of a scheduling block (and therefore exec block) in the output ASDM</description>
	    <value>2700s</value>
    </param>
    <param type="bool" name="apcorrected">
	    <description>data to be marked as having atmospheric phase correction</description>
	    <value>True</value>
    </param>
    <param type="bool" name="verbose">
	    <description>produce log output</description>
	    <value>True</value>
    </param>
    <param type="bool" name="showversion">
	    <description>Report the version of ASDM class set being used</description>
	    <value>True</value>
    </param>

    <param type="string" name="useversion" >
	    <description>Selects the version of MS2asdm to be used (\'v3\' (default and only option presently))</description>
	    <value>v3</value>
	    <allowed kind="enum">
	      <value>v3</value>
	      <value></value>
	    </allowed>
    </param>

    </input>

  <returns type="bool"/>

  <example>

  Keyword arguments:
  vis -- MS name,
         default: none

  asdm -- Name of output ASDM file (directory),
          default: none; example: asdm='ExecBlock3'

  datacolumn -- specifies which of the MS data columns (data,
           corrected, or model) should be used as the
           visibilities in the ASDM, default: data

  archiveid -- the X0 in uid://X0/X1/X&lt;running&gt;
               default: "S0"

  rangeid -- the X1 in uid://X0/X1/X&lt;running&gt;
             default: "X1"

  subscanduration -- maximum duration of a subscan in the output ASDM
	             default: "24h"

  sbduration -- maximum duration of a scheduling block in the output ASDM
	             default: "2700s"

  apcorrected -- If true, the data in column datacolumn will be marked
	         as having atmospheric phase correction, default: True

  verbose     -- produce log output, default: True

  showversion -- report the version of the ASDM class set, 
                 default: True

  useversion -- Selects the version of MS2asdm to be used (\'v3\' (default) or \'v2\' (version before May 2011))
                default: v3

  exportasdm(vis='ngc4826.ms', asdm='uid___S021_X1418_X1', 
  datacolumn='corrected', archiveid='S021', rangeid='X1418', 
  verbose=False)
  will produce an ASDM named 'uid___S021_X1418_X1' using the 
  datacolumn 'corrected' in the MS 'ngc4826.ms' with minimal
  log output. 

  Note concerning ALMA data: exportasdm presently is not able to export 
  from MSs containing WVR data. If you attempt to export such an MS, you
  will receive an error message saying that you can only export data of
  processor type "CORRELATOR". It will also give you the list of SPWs
  which contain CORRELATOR data. You will then have to split out these
  SPWs using the task "split" and run exportasdm on the resulting MS. 

  </example>

</task>

</casaxml>
