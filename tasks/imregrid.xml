<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">

<task type="function" name="imregrid" category="analysis">
<shortdescription>regrid an image onto a template image</shortdescription>
<description>
Imregrid will regrid an input image onto a template image
coordinate system.  The input and template images must have
the same coordinate structure.
</description>
<input>
	<param type="string" name="imagename" mustexist="true">
		<description>Name of the source image</description>
		<value></value>
	</param>
	<param type="any" name="template">
        <any type="variant"/>
		<description>A dictionary, refcode, or name of an image that provides the output shape and coordinate system</description>
		<value type="string">get</value>
	</param>

	<param type="string" name="output">
		<description>Name for the regridded image</description>
		<value></value>
	</param>

     <param type="bool" direction="in" name="asvelocity">
        <description>Regrid spectral axis in velocity space rather than frequency space?</description>
        <value>False</value>
     </param>
     <param type="intArray" direction="in" name="axes">
        <description>The pixel axes to regrid. -1 => all.</description>
         <value>-1</value>
     </param>
     <param type="intArray" name="shape" subparam="true">
        <description>Shape of the output image. Only used if template is an image. If not specified (-1), the output image shape is set equal to the input image shape.</description>
        <value>-1</value>
     </param>
     <constraints>
        <when param="template">
            <notequals type="string" value="get">
                <default param="shape"><value type="intArray">-1</value></default>
            </notequals>
        </when>
     </constraints>
</input>
<example>

imregrid: regrid an image to a new coordinate system.

Keyword arguments:
imagename   Name of the image that needs to be regridded
            default: none; example: imagename='orion.image'
template    Dictionary, reference code, or imagename defining the new
            shape and coordinate system, or 'get' to return the template
            dictionary for imagename.  Recognized reference codes are:
            'J2000', 'B1950', 'B1950_VLA', 'GALACTIC', 'HADEC', 'AZEL',
            'AZELSW', 'AZELNE', 'ECLIPTIC', 'MECLIPTIC', 'TECLIPTIC',
            and 'SUPERGAL'.
            default: 'get'; example: template='orion_j2000.im'
shape       Shape of the output image. Only used if template is an image.
            If not specified (-1), the output image shape is set equal to
            the input image shape.
output      Name for the regridded image
            default: imagename + '.regridded'; example: imagename='orion_shifted.im'
asvelocity  Regrid spectral axis with respect to velocity, not frequency?
            default: False
axes        The pixel axes to regrid. -1 => all.
async       Run task in a separate process (return CASA prompt)
            default: False; example: async=True
                
The new coordinate system is defined by the template parameter,
which can be:
    * a recognized reference frame string. This will rotate the image and the coordinate system so that
      the new reference frame's axes are aligned to the cardinal directions (left-right, up-down).
      Rotation occurs about the center direction pixel. If this pixel is not the reference pixel,
      a temporary copy of the original image is created and the coordinate system is adjusted so
      the center direction pixel is the reference pixel. The coordinate system of the input image
      is not modified and the output image's reference direction pixel is the center pixel.
      Note that the conversion between one frame and another in general becomes less accurate
      as distance from the output image's reference pixel increases.
    * a {'csys': csys_record, 'shap': shape} dictionary,
    * 'get', which does not regrid but returns the template dictionary
      for imagename, suitable for modification and reuse, or
    * the name of an image to get the coordinate system and shape
      from.  The input and template images must have the same
      coordinate structure.
      
If one of the axes to be regridded is a spectral axis and asvelocity=T,
the axis will be regridded to match the velocity, not the frequency,
description of the template coordinate system. Thus the output pixel
values will correspond only to the velocity, not the frequency, of the
output axis.

If an image has per-plane beams and one attempts to regrid the spectral axis,
an exception is thrown.

# convert an input image that has GALACTIC coordinates to an image with J2000 coordinates

imregrid(imagename="mygal.im", template="J2000", output="myj2000.im")



</example> 

</task>
</casaxml>
