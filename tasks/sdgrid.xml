<?xml version="1.0" encoding="UTF-8"?>
<?xml-stylesheet type="text/xsl" ?>
<casaxml xmlns="http://casa.nrao.edu/schema/psetTypes.html"
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
xsi:schemaLocation="http://casa.nrao.edu/schema/casa.xsd
file:///opt/casa/code/xmlcasa/xml/casa.xsd">


<!-- This is the param set for sdgrid -->

<task type="function" name="sdgrid" startup="false" category="single dish">

  <shortdescription>SD task: gridding single dish data</shortdescription>

  <description>SD task for gridding spectra

        Task Version 2011-12-02 TN
</description>

  <input>
    <param type="any" name="infiles"  mustexist="true">
    <description>(list of) input SD dataset</description>
    <any type="variant" limittype="string stringArray"/>
    <value type="stringArray">""</value>
    </param>

    <param type="any" name="antenna">
      <description>antenna name(s) or id(s)</description>
      <any type="variant" limittype="string int"/>
      <value type="int">-1</value>
    </param>

    <param type="intArray" name="scanlist">
      <description>list of scans to use (e.g. [1,2,3,4])</description>
      <value></value>
    </param>

    <param type="int" name="ifno">
      <description>IFNO for gridding</description>
      <value>-1</value>
    </param>

    <param type="any" name="pollist">
      <description>POLNO for gridding</description>
      <any type="variant" limittype="int intArray"/>
      <value type="intArray"></value>
    </param>

    <param type="string" name ="gridfunction">
      <description>gridding function for imaging ("BOX","SF","GAUSS","PB")</description>
      <value>BOX</value>
      <allowed kind="enum">
        <value>BOX</value>
        <value>GAUSS</value>
        <value>GJINC</value>
        <value>PB</value>
        <value>SF</value>
        <value>box</value>
        <value>gauss</value>
        <value>gjinc</value>
        <value>pb</value>
        <value>sf</value>
      </allowed>
    </param>

    <param type="int" name="convsupport" subparam="true">
      <description>truncate of convolution kernel</description>
      <value>-1</value>
    </param>

    <param type="any" name="truncate" subparam="true">
      <description>truncation radius of convolution kernel</description>
      <any type="variant" limittype="string int double"/>
      <value type="int">-1</value>
    </param>

    <param type="any" name="gwidth" subparam="true">
            <description>HWHM for gaussian</description>
            <any type="variant" limittype="string int double"/>
            <value type="int">-1</value>
    </param>

    <param type="any" name="jwidth" subparam="true">
            <description>c-parameter for jinc function</description>
            <any type="variant" limittype="string int double"/>
            <value type="int">-1</value>
    </param>
   
    <param type="string" name="weight">
      <description>weight type</description>
      <value>UNIFORM</value>
      <allowed kind="enum">
        <value>UNIFORM</value>
        <value>TINT</value>
        <value>TSYS</value>
        <value>TINTSYS</value>
        <value>uniform</value>
        <value>tint</value>
        <value>tsys</value>
        <value>tintsys</value>
      </allowed>
    </param>

    <param type="bool" name="clipminmax">
      <description>clip minimum and maximum values during gridding</description>
      <value>False</value>
    </param>

    <param type="string" name="outfile">
      <description>output image name</description>
      <value></value>
    </param>

    <param type="bool" name="overwrite">
      <description>overwrite option</description>
      <value>False</value>
    </param>

    <param type="any" name="npix">
      <description>number of pixels in x and y, symmetric for single value</description>
      <any type="variant" limittype="int intArray"/>
      <value type="int">-1</value>
    </param>

    <param type="any" name="cell">
      <description>x and y cell size. default unit arcsec</description>
      <any type="variant" limittype="string stringArray double doubleArray"/>
      <value type="string"></value>
    </param>

    <param type="any" name="center">
      <description>Image center</description>
      <any type="variant" limittype="string stringArray doubleArray"/>
      <value type="string"></value>
    </param>

    <param type="bool" name="plot">
      <description>Plot result or not</description>
      <value>False</value>
    </param>

    <constraints>
      <when param="gridfunction">
        <equals value="BOX"/>
        <equals value="box"/>
        <equals value="SF">
          <default param="convsupport" type="int"><value>-1</value></default>
        </equals>
        <equals value="sf">
          <default param="convsupport" type="int"><value>-1</value></default>
        </equals>
        <equals value="GAUSS">
          <default param="truncate" type="int"><value>-1</value></default>
          <default param="gwidth" type="int"><value>-1</value></default>
        </equals>
        <equals value="gauss">
          <default param="truncate" type="int"><value>-1</value></default>
          <default param="gwidth" type="int"><value>-1</value></default>
        </equals>
        <equals value="GJINC">
          <default param="truncate" type="int"><value>-1</value></default>
          <default param="gwidth" type="int"><value>-1</value></default>
          <default param="jwidth" type="int"><value>-1</value></default>
        </equals>
        <equals value="gjinc">
          <default param="truncate" type="int"><value>-1</value></default>
          <default param="gwidth" type="int"><value>-1</value></default>
          <default param="jwidth" type="int"><value>-1</value></default>
        </equals>
        <equals value="PB"/>
        <equals value="pb"/>
      </when>
    </constraints>

  </input>

  <returns type="void"/>

  <example>
  Keyword arguments:
        infiles -- name of input SD dataset. can be list.
                example: 'testimage.asap' 
                         ['testimage1.asap','testimage2.asap']
        antenna -- select data based on antenna name(s) or id(s)
                default: -1
                example: 0, 'DV01'
        scanlist -- list of scan numbers to process
                default: [] (use all scans)
                example: [21,22,23,24]
        ifno -- IFNO to be gridded
                default: -1 (only process IFNO in the first row)
                example: 1
        pollist -- POLNO to be gridded
                default: [] (all polarizations)
                example: 1,[0,1]
        gridfunction -- gridding function 
                options: 'BOX' (Box-car), 'SF' (Spheroidal), 
                         'GAUSS' (Gaussian), 'PB' (Primary-beam)
                default: 'BOX'
                example: 'SF'
            &gt;&gt;&gt; gridfunction expandable parameter:
               truncate -- truncate of convolution kernel, not available 
                        for BOX gridding
                   default: -1 (use default for each gridfunction)
                   example: 3
        weight -- weight type (both lower-case and upper-case are 
                  acceptable)
                options: 'UNIFORM',
                         'TSYS'  (1/Tsys**2 weighted)
                         'TINT'  (integration time weighted)
                         'TINTSYS'  (Tint/Tsys**2)
                default: 'UNIFORM'
        clipminmax -- do min/max cliping if True
                default: False
        outfile -- output data name
                default: '' (outfile will be set to infile+'.grid')
                example: 'mydata.asap.grid'
        overwrite -- overwrite option for outfile
                default: False (not overwrite)
                options: True, False
                example: if True, existing file will be overwritten
        npix -- x and y image size in pixels, symmetric for single value
                default: -1 (automatically calculated from cell size and 
                             the data)
                example: npix=200 (equivalent to [200,200])
        cell -- x and y cell size. default unit arcsec
                default: '' (automatically calculated from npix if it is 
                             set, otherwise '1.0arcmin')
                example: cell=['0.2arcmin, 0.2arcmin']
                         cell='0.2arcmin' (equivalent to example above)
                         cell=12.0 (interpreted as '12.0arcsec'='0.2arcmin')
        center -- grid center
                default: '' (automatically calculated from the data)
                example: 'J2000 13h44m00 -17d02m00'
                         ['05:34:48.2', '-05.22.17.7'] (in J2000 frame)
                         [1.46, -0.09] (interpreted as radian in J2000 frame)
        plot -- Plot result or not
                default: False (not plot)
                example: if True, result will be plotted

        DESCRIPTION:

        The sdgrid task performs spatial gridding according to the user 
        specification of spatial grid, convolution function, etc.

        For grid configuration, the task supplements necessary information 
        by referring input data if any of gridding parameter ('npix', 
        'cell', or 'center') is not specified by the user. If 'center' is 
        default value (empty string), central position of the grid will be 
        set to the center of observed area, i.e. x=0.5*(xmax+xmin), 
        y=0.5*(ymax+ymin). If either 'cell' or 'npix' is set, unspecified 
        one will be calculated from the others. In that case, total extent of 
        the grid will be set to cover all observed position. If neither 'cell' 
        nor 'npix' is set, cell size will be set to 1.0 arcmin and number of 
        pixel will be calculated based on that cell size.
 
        Currently, only J2000 frame is supported.
 
        The parameter gridfunction sets gridding function for imaging. 
        Currently, the task supports 'BOX' (Box-car), 'SF' (Prolate 
        Spheroidal Wave Function), 'GAUSS' (Gaussian). and 'PB' 
        (Primary Beam, not implemented yet). For 'PB', correct 
        antenna informations should be included in input file. 
        The 'truncate' parameter specifies truncate of the convolution kernel 
        in pixel unit. For Gaussian gridding, 'width' is treated as HWHM 
        and actual width (the width that convolution function has non-zero 
        value) is set to 4*HWHM to take into account contribution from 
        Gaussian tail. Otherwise, 'width' is treated as actual width of the 
        convolution function. 

        Boolean parameter 'plot' controls whether gridded result is plotted 
        or not. If True, color map of gridded data will be shown. Pixel 
        center and observed position are overlayed as blue dot and red dot, 
        respectively. Currently, channel averaged value will be plotted.
  </example>

</task>

</casaxml>
